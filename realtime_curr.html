<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/style.css">
<script type="text/javascript" src="js/user.js"></script>
<script type="text/javascript" src="js/cambistorici.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script>
	// inizializzo le variabili globali
	from = "USD";
	val1 = 1;
	date = "2017-01-01";

// mio
  // $(document).ready(function() {
  //
  //   $.get("files/currencies.html", function (data){
  //
  //     var Costruttore_HTML_img_Bandiere = ""
  //     for (var i = 0; i < data.length; i++) {
  //       console.log(data.length);
  //     }
  //
  //
  //   });
  //
  // });

// suo

// 	// genero HTML bandierine
// 	$(document).ready(function () {
// 		$.get("files/currencies.html", function (data) {
//       // console.log(data);
// 		data2 = data.split(">",1);
// 		// console.log(data2);
// 		var Costruttore_HTML_img_Bandiere ="";
// 		// console.log(data2.length);
// 		for (i = 0; i < data2.length; i++) {
// 			var flg = String(data2.slice(16,2));
// 			flg = flg.toLocaleLowerCase();
// 			// console.log(data2.slice(9));
// 			Costruttore_HTML_img_Bandiere += '<img class="bandiere" src="currency-flags/src/flags/'+flg+'.png" '+data2.slice(9)+' />\n'
// 			}
// 		console.log(Costruttore_HTML_img_Bandiere);
// //                    $('#container').html(myHrefCollection);
// 		});
// 	});
</script>

<style>
	img { margin: 2px; width: 9%; }
	img { border: 1px solid blue; }
	img:hover { outline: 4px solid yellow; }

	/* Chrome, Safari, Opera */
	@-webkit-keyframes mymove { 50% {outline: 5px solid lightblue;} }

	/* Standard syntax */
	@keyframes mymove { 50% {outline: 5px solid lightblue;} }
</style>

<head>
<title>Analisi Finanziaria</title>
</head>
<body>

  <div class="container">

    <div class="nav">
      <ul>
        <li class="logo"><a href="index.html">MONETARIA</a></li>
        <li class="home"><a href="index.html">Home</a></li>
        <li class="currencies-page"><a class="active" href="#">Valute</a></li>
        <li class="wallet-page"><a href="wallet.html">Portafoglio</a></li>
        <li class="contacts"><a href="contacts.html">Contatti</a></li>
        <li class="about"><a href="aboutus.html">Chi siamo</a></a></li>
      </ul>
    </div>

    <!-- aggiungo uno spazio vuoto,  -->
    <div>
      &nbsp;
    </div>
    <!-- box contentente i vari bottoni che al click cambiano il contenuto del box successivo -->
    <div class="box1" style="height: auto; text-align:center; padding: 10px" id="bottoni">
      <div class="content" id="content">
          <button style="height:30px;" id="storica">Cambio valuta storica</button>
          <button style="height:30px;" id="live">Cambi valute live</button>
      </div>
    </div>

    <div class="box1" style="height:50px; padding: 10px; display: none;" id="not_logged">
      <div class="content" id="content">
        <p>
          Se vuoi accedere alla funzionalità valute devi effettuare il login..
        </p>
      </div>
    </div>

    <!-- <script>
      function funzionetest() {

        $("#zonaDinamica").show();
        // var stampa = currencyconverter();
        // console.log(stampa);
        var titolo = $('img', this).attr('title');
        document.getElementById("zonaDinamica").innerHTML = titolo;
        }
    </script> -->

    <div>
      &nbsp;
    </div>
    <div class="box1" id="bandiere" style="text-align:center; height:auto; padding: 10px">
      <div class="content" id="content">
        <img id='USD' src="currency-flags/src/flags/usd.png" class="bandiere" width="10%" title='United States Dollar' />
        <img id='BTC' src="currency-flags/src/flags/btc.png" class="bandiere" width="10%" title='Bitcoin' />
        <img id='AED' src="currency-flags/src/flags/aed.png" class="bandiere" width="10%" title='United Arab Emirates Dirham' />
        <img id='ARS' src="currency-flags/src/flags/ars.png" class="bandiere" width="10%" title='Argentine Peso' />
        <img id='AUD' src="currency-flags/src/flags/aud.png" class="bandiere" width="10%" title='Australian Dollar' />
        <img id='BRL' src="currency-flags/src/flags/brl.png" class="bandiere" width="10%" title='Brazilian Real' />
        <img id='CAD' src="currency-flags/src/flags/cad.png" class="bandiere" width="10%" title='Canadian Dollar' />
        <img id='CHF' src="currency-flags/src/flags/chf.png" class="bandiere" width="10%" title='Swiss Franc' />
        <img id='CNY' src="currency-flags/src/flags/cny.png" class="bandiere" width="10%" title='Chinese Yuan' />
        <img id='COP' src="currency-flags/src/flags/cop.png" class="bandiere" width="10%" title='Colombian Peso' />
        <img id='CZK' src="currency-flags/src/flags/czk.png" class="bandiere" width="10%" title='Czech Republic Koruna' />
        <img id='EGP' src="currency-flags/src/flags/egp.png" class="bandiere" width="10%" title='Egyptian Pound' />
        <img id='ETB' src="currency-flags/src/flags/etb.png" class="bandiere" width="10%" title='Ethiopian Birr' />
        <img id='EUR' src="currency-flags/src/flags/eur.png" class="bandiere" width="10%" title='Euro' />
        <img id='GBP' src="currency-flags/src/flags/gbp.png" class="bandiere" width="10%" title='British Pound Sterling' />
        <img id='HKD' src="currency-flags/src/flags/hkd.png" class="bandiere" width="10%" title='Hong Kong Dollar' />
        <img id='ILS' src="currency-flags/src/flags/ils.png" class="bandiere" width="10%" title='Israeli New Sheqel' />
        <img id='INR' src="currency-flags/src/flags/inr.png" class="bandiere" width="10%" title='Indian Rupee' />
        <img id='IQD' src="currency-flags/src/flags/iqd.png" class="bandiere" width="10%" title='Iraqi Dinar' />
        <img id='IRR' src="currency-flags/src/flags/irr.png" class="bandiere" width="10%" title='Iranian Rial' />
        <img id='JPY' src="currency-flags/src/flags/jpy.png" class="bandiere" width="10%" title='Japanese Yen' />
        <img id='KPW' src="currency-flags/src/flags/kpw.png" class="bandiere" width="10%" title='North Korean Won' />
        <img id='KRW' src="currency-flags/src/flags/krw.png" class="bandiere" width="10%" title='South Korean Won' />
        <img id='MXN' src="currency-flags/src/flags/mxn.png" class="bandiere" width="10%" title='Mexican Peso' />
        <img id='NOK' src="currency-flags/src/flags/nok.png" class="bandiere" width="10%" title='Norwegian Krone' />
        <img id='RUB' src="currency-flags/src/flags/rub.png" class="bandiere" width="10%" title='Russian Ruble' />
        <img id='SGD' src="currency-flags/src/flags/sgd.png" class="bandiere" width="10%" title='Singapore Dollar' />

      </div>
    </div>

    <script>

  	//	jQuery: MOUSEOVER SU BANDIERA

  		$(document).ready(function(){
  		  $(".bandiere").mouseover(function(){
  				to = $(this).attr("value");
  	//			val1 = $(#val1).attr("value");
  	//			date = $(#giorno).attr("value");
  				converti = 999; // valore base per i test di controllo
  	  		// currency_graph(from, to, val1, date, function(val2){
  	  		// 	converti=val2;
  	  		// 	console.log("valore "+converti); });
  	      $("#zonaDinamica").fadeIn();
  				var stampavaluta = "il "+date+" "+val1+" "+from+" equivale a "+converti+" "+ $(this).attr("title")+" ("+to+")";
  				$("#zonaDinamica").text(stampavaluta);
  			});
  			$(".bandiere").mouseleave(function(){ $("#zonaDinamica").fadeOut(); })
  		});


  	//	jQuery: CLICK SU BANDIERA
  		$(document).ready(function(){
  			$(".bandiere").click(function(){
  				from = $(this).attr("value");
  				$("img").css("animation", "mymove 0s");
  				$(this ).css("animation", "mymove 3s infinite");
  			});
  		});

  	//	jQuery: DOPPIO CLICK SU BANDIERA
  		$(document).ready(function(){
  			$(".bandiere").dblclick(function(){
  				window.open();
  				alert("window.open() apre popup con grafico");
  			});
  		});
  	</script>

    <div>
    &nbsp;
    </div>
    <div class="box1" id="zonaDinamica" style="height:50px; padding: 10px; display: none;">
      <div class="content" id="content">
        
      </div>
    </div>


    <!-- box contentente il convertitore di valute, l'altezza è fissata -->
    <div class="box1" style="height: auto" id="box_storico">
      <div class="content" id="content">
          <h2>Conversione storica di valute e criptovalute</h2>
          <p>Strumento semplice per convertire valute/criptovalute, nei principali cambi</p>
          <p>Scegli la valuta base, la valuta di destinazione della conversione e la data storica
          in cui effettuare il cambio.</p>
          <div class="flex-container">
            <div>
              <!-- organizzo il contenuto in una tabella -->
              <table class="table1">
                <tr>
                  <td>
                    Seleziona una valuta:
                  </td>
                </tr>
                <tr>
                  <td>
                    <select class="currencies" id="curr_1">
                      <!-- carico le options e seleziono il valore di default -->
                      <script type="text/javascript">
                      $("#curr_1").load("files/currencies.html", function(){
                        $("#curr_1").val("EUR");
                      });
                      </script>
                    </select>
                  </td>
                </tr>
                <div>
                  &nbsp;
                </div>
                <tr>
                  <td>
                    <input type="text" id="val1" name="val1" size="19"/>
                  </td>
                </tr>
              </table>
            </div>
            <div>
              <table class="table1">
                <tr>
                  <td>
                    Seleziona una valuta:
                  </td>
                </tr>
                <tr>
                  <td>
                    <select class="currencies" id="curr_2">
                      <script type="text/javascript">
                      $("#curr_2").load("files/currencies.html", function(){
                        $("#curr_2").val("USD");
                      });
                      </script>
                    </select>
                  </td>
                </tr>
                <div>
                  &nbsp;
                </div>
                <tr>
                  <td>
                    <input type="text" id="val2" name="val2" size="19"/>
                  </td>
                </tr>
              </table>
            </div>
            <div style="background: inherit;">
              In quale data?
              <input id="giorno" type="date"  value="2017-01-01" min="2010-01-01"/>
              <script type="text/javascript">
            		var today = new Date();
            		var dd = today.getDate();
            		var mm = today.getMonth()+1; //zero è gennaio
            		var yyyy = today.getFullYear();
            		if(dd<10) {dd='0'+dd}
            		if(mm<10) {mm='0'+mm}
            		today = yyyy+'-'+mm+'-'+dd;
            		document.getElementById("giorno").setAttribute("max", today);
              </script>
              <br />
              <p></p>
              <input type="submit" onclick="currencyconverter(); return false;" value="Converti" />
            </div>
          </div>
      </div>
    </div>


    <script type="text/javascript">
    // se l'utente non è loggato, non accede alla feature portafoglio.
       if (sessionStorage.length != 1) {
         // faccio il display di un messaggio di errore
         $("#not_logged").show();
         $("#bottoni").hide();
         $("#bandiere").hide();
         $("#box_storico").hide();
       }
       else {

         $("#not_logged").hide();
         $("#bottoni").show();
         $("#bandiere").hide();
         $("#box_storico").show();

         $("#live").click(function(){
           $("#bandiere").fadeIn();
           $("#box_storico").fadeOut();
         });

         $("#storica").click(function(){
           $("#box_storico").fadeIn();
           $("#bandiere").fadeOut();
           $("#zonaDinamica").hide();
         });

       }
    </script>

  </div>

</body>

</html>
